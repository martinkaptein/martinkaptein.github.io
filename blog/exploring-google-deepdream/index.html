
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Exploring Google DeepDream and getting very cool results. My experiences and modifications to the source code.">
      
      
        <link rel="canonical" href="https://martinkaptein.github.io/blog/exploring-google-deepdream/">
      
      
        <meta name="author" content="Martin Kaptein">
      
      
        <link rel="shortcut icon" href="../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.8.0">
    
    
      
        <title>Exploring Google DeepDream and getting nice images</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-bfecc7305d.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-02c2a4388f.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="https://martinkaptein.github.io" title="Martin Kaptein" class="md-logo md-header-nav__button">
            <img src="../../images/multimedia.png" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Technical Blog
                </span>
              
            
            Exploring Google DeepDream
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../images/multimedia.png">
      </i>
    
    Martin Kaptein
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Technical Blog
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Technical Blog
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hugo-with-travis-ci-on-gh-pages/" title="Hugo with Travis CI on GitHub Pages" class="md-nav__link">
      Hugo with Travis CI on GitHub Pages
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Exploring Google DeepDream
      </label>
    
    <a href="./" title="Exploring Google DeepDream" class="md-nav__link md-nav__link--active">
      Exploring Google DeepDream
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-google-deepdream" title="Introduction to Google DeepDream" class="md-nav__link">
    Introduction to Google DeepDream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-source-image" title="The source image" class="md-nav__link">
    The source image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#my-results" title="My results" class="md-nav__link">
    My results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modifications-to-the-source-code" title="Modifications to the source code" class="md-nav__link">
    Modifications to the source code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" title="Conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pythoncms/" title="Python Blog Generator" class="md-nav__link">
      Python Blog Generator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Musical Blog
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Musical Blog
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rachmaninoff-op39-no5-analysis/" title="Analysis of the Rachmaninoff Etude-Tableaux op.39 no.5" class="md-nav__link">
      Analysis of the Rachmaninoff Etude-Tableaux op.39 no.5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../liszt-sonata-analysis/" title="Liszt Sonata Analysis" class="md-nav__link">
      Liszt Sonata Analysis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../media/" title="Media" class="md-nav__link">
      Media
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contact/" title="Contact" class="md-nav__link">
      Contact
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-google-deepdream" title="Introduction to Google DeepDream" class="md-nav__link">
    Introduction to Google DeepDream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-source-image" title="The source image" class="md-nav__link">
    The source image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#my-results" title="My results" class="md-nav__link">
    My results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modifications-to-the-source-code" title="Modifications to the source code" class="md-nav__link">
    Modifications to the source code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" title="Conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <p><em>June 2, 2017</em></p>
<p>By <strong>Martin Kaptein</strong></p>
<hr />
<h1 id="playing-around-with-googles-deepdream-and-how-to-get-best-results">Playing around with Google's DeepDream and how to get best results</h1>
<p>In this Blog post I would like to explore Google DeepDream and report about my experiences with it.</p>
<h2 id="introduction-to-google-deepdream">Introduction to Google DeepDream</h2>
<p>Google DeepDream is an <a href="https://github.com/google/deepdream">open source program, created by Google</a>, which uses a convolutional neural networks (CNN's) to find and enhance patterns in images. </p>
<p>This can lead to very cool-looking results.</p>
<p>What I like about Google DeepDream is that it provides a very visual approach and representation of an, otherwise, very abstract topic.</p>
<p>In this Blog post I will share some of my results and settings which I used.</p>
<h2 id="the-source-image">The source image</h2>
<p>I used an image (which I took myself) of clouds:</p>
<p><img alt="source image as input for Google DeepDream" src="../../images/cloudsw500.jpg" /></p>
<p><em>My source image, input for DeepDream</em></p>
<p>In my experience the image dimension should be somewhere between 700 pixels sq and 200 pixels sq (not necessarily square, of course). Large images take an extremely long time to process, but can also provide really beautiful results.</p>
<p>Also, the size of the <em>Dream stuff</em> doesn't scale with the image (probably depends on the trained model).</p>
<p>Intrestingly enough, images with clouds tend to be most interesting. Humans do also tend to interpret different things when looking at clouds, so that's a nice parallel.</p>
<h2 id="my-results">My results</h2>
<p>Here are some of my favourite results I got:</p>
<p><img alt="DeepDream output 1" src="../../images/cloudsw500inc4cout.jpg" /></p>
<p><em>Default settings</em></p>
<p>This is done, basically with the default settings of Google (but used <strong>98 iterations</strong>)</p>
<pre><code>make_step(net, step_size=1.5, end='inception_4c/output', jitter=32, clip=True, objective=objective_L2)

deepdream(net, base_img, iter_n=11, octave_n=4, octave_scale=1.4, 
          end='inception_4c/output', clip=True, **step_params)
</code></pre>
<p><img alt="DeepDream output 2" src="../../images/inc4bout.jpg" /></p>
<p><em>Layer: end='inception_4b/output'</em></p>
<p>Whilst you can see in the first image more or less complete dogs, here it's more ears and eyes. This makes sense, as it's a 'lower level layer'.</p>
<p><img alt="DeepDream output 3" src="../../images/inc5aoutx123.jpg" /></p>
<p><em>Layer: end='inception_5a/output'</em></p>
<p>This yields a very abstract result. Probably my favourite. This particular picture <strong>used 123 iterations</strong> (more on that later).</p>
<p><img alt="DeepDream output 4" src="../../images/inc5bout.jpg" /></p>
<p><em>Layer: end='inception_5b/output'</em></p>
<p>Well, I leave this one to you.</p>
<p><em>Note: I had to down-scale these images, so that this site loads a bit faster :P I hope that's ok</em></p>
<h2 id="modifications-to-the-source-code">Modifications to the source code</h2>
<p>The only modification I made was to 're-dream' every image (quite a large number of times).</p>
<p>This helps to get a more vivid result.</p>
<p>Here is the script I made (it saves every iteration, so you can make a nice .gif or something later). Also, it doesn't crash due to memory issues.</p>
<pre><code>
for i in xrange(somenumber):
    frame = deepdream(net, frame)
    PIL.Image.fromarray(np.uint8(frame)).save(&quot;output/%04d.jpg&quot;%frame_i)
    frame = np.float32(PIL.Image.open('output/%04d.jpg'%frame_i))
    frame_i += 1

</code></pre>

<h2 id="conclusion">Conclusion</h2>
<p>I personally like this topic very much. Will probably write other blog posts about this too (for example, about using different models).</p>
                
                  
                
              
              
                
                  <h2 id="__comments">Comments</h2>
                  <div id="disqus_thread"></div>
<script>
  var disqus_config = function () {
    this.page.url = "https://martinkaptein.github.io/blog/exploring-google-deepdream/";
    this.page.identifier =
      "/blog/exploring-google-deepdream/";
  };
  (function() {
    var d = document, s = d.createElement("script");
    s.src = "//martinkaptein.disqus.com/embed.js";
    s.setAttribute("data-timestamp", +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../hugo-with-travis-ci-on-gh-pages/" title="Hugo with Travis CI on GitHub Pages" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Hugo with Travis CI on GitHub Pages
              </span>
            </div>
          </a>
        
        
          <a href="../pythoncms/" title="Python Blog Generator" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Python Blog Generator
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 Martin Kaptein
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://www.facebook.com/martin.kaptein" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://twitter.com/MartinKaptein/" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.instagram.com/martinkaptein" class="md-footer-social__link fa fa-instagram"></a>
    
      <a href="https://www.snapchat.com/add/martinkaptein" class="md-footer-social__link fa fa-snapchat"></a>
    
      <a href="https://www.youtube.com/channel/UCosUIzMUriRTgg60vh3EwCQ" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-1d6ee6ee6c.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-86096566-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>